<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FBL Hexplorer Companion</title>
    <link rel="icon" type="image/x-icon" href="img/icons/logo.svg">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header id="site-header">
        <div id="header-controls">
            <button id="btn-save-game" class="header-btn" title="Salvar Estado">
                <img src="img/icons/buttons/header/save.svg" alt="" class="btn-icon">
                <span>Salvar</span>
            </button>
            <button id="btn-load-game" class="header-btn" title="Carregar Estado">
                <img src="img/icons/buttons/header/load.svg" alt="" class="btn-icon">
                <span>Carregar</span>
            </button>
            <button id="btn-reset-game" class="header-btn" title="Resetar Jogo">
                <img src="img/icons/buttons/header/reset.svg" alt="" class="btn-icon">
                <span>Reset</span>
            </button>
            <button id="btn-info-game" class="header-btn" title="Informações">
                <img src="img/icons/buttons/header/info.svg" alt="" class="btn-icon">
                <span>Info</span>
            </button>
            <input type="file" id="file-input-load" accept=".json" style="display: none;">
        </div>
        <div id="header-branding">
            <img src="img/icons/logo.svg" alt="Logo" id="header-logo">
            <h1>FBL Hexplorer Companion</h1>
        </div>
    </header>

    <!-- Onboarding Button Container -->
    <div id="start-journey-container" style="text-align: center; margin-top: 50px;">
        <button id="btn-initial-start" class="travel-btn" style="margin: 0 auto; padding: 15px 30px; font-size: 1.2em;">
            <img src="img/icons/mastheads/journal.svg" class="btn-icon" style="filter: brightness(0) invert(1);">
            INICIAR JORNADA
        </button>
    </div>

    <div id="main-content" style="display: none;">

        <div id="info-container">
            <div id="info-display">
                <div class="masthead">
                    <div class="masthead-icon"><img src="img/icons/mastheads/rolls.svg" alt=""></div>
                    <div class="masthead-title">Procedimentos de Viagem</div>
                </div>
                <div id="info-display-text"></div>
            </div>
        </div>

        <div id="bottom-container">

            <div id="bottom-left-column">

                <div id="selected-hexweather-container">
                    <div class="masthead">
                        <div class="masthead-icon"><img src="img/icons/mastheads/weather.svg" alt=""></div>
                        <div class="masthead-title" id="selected-hexagon-title">Selecione o Clima</div>
                    </div>
                    <svg id="solitary-hexagon-svg" viewBox="-50 -50 100 100"></svg>
                </div>

                <div id="selected-terrain">
                    <div class="masthead">
                        <div class="masthead-icon"><img src="img/icons/mastheads/terrain.svg" alt=""></div>
                        <div class="masthead-title" id="selected-terrain-title">Selecione o Terreno</div>
                    </div>
                    <svg id="solitary-terrain-svg" viewBox="-50 -50 100 100"></svg>
                </div>

            </div>

            <div id="calendar-container">
                <div class="masthead">
                    <div class="masthead-icon"><img src="img/icons/mastheads/journal.svg" alt=""></div>
                    <div class="masthead-title" id="current-day-display">Selecione o mês e dia para iniciar</div>
                </div>

                <div id="calendar-content-wrapper">
                    <div id="travel-controls">
                        <div class="desbravar-container">
                            <button id="btn-desbravar" class="travel-btn"><img src="img/icons/buttons/explore.svg"
                                    alt="" class="btn-icon">DESBRAVAR</button>
                            <div class="mounted-switch-container">
                                <label class="switch">
                                    <input type="checkbox" id="toggle-mounted">
                                    <span class="slider round"></span>
                                </label>
                                <label for="toggle-mounted">Todos Montados?</label>
                            </div>
                        </div>
                        <button id="btn-permanecer" class="travel-btn"><img src="img/icons/buttons/stay.svg" alt=""
                                class="btn-icon">PERMANECER</button>
                        <button id="btn-advance-day" class="travel-btn hidden">AVANÇAR PARA O PRÓXIMO DIA</button>
                    </div>

                    <div id="day-details-main"></div>

                    <div id="journal-section">
                        <h3>Registrar Anotação</h3>

                        <div id="journal-entries-list" class="journal-entries-list"></div>

                        <div id="journal-controls"
                            style="margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
                            <label for="journal-quarter-select">Momento:</label>
                            <select id="journal-quarter-select"
                                style="padding: 5px; border-radius: 4px; background: var(--col-bg-surface); color: var(--col-text-primary); border: 1px solid var(--col-accent-cool);">
                                <option value="0">Manhã</option>
                                <option value="1">Tarde</option>
                                <option value="2">Anoitecer</option>
                                <option value="3">Noite</option>
                            </select>
                        </div>

                        <div class="editor-toolbar">
                            <button class="tool-btn" data-cmd="bold" title="Negrito"><b>B</b></button>
                            <button class="tool-btn" data-cmd="italic" title="Itálico"><i>I</i></button>
                            <button class="tool-btn" data-cmd="underline" title="Sublinhado"><u>U</u></button>
                            <button class="tool-btn" data-cmd="superscript" title="Sobrescrito">X<sup>2</sup></button>
                            <div class="separator" style="width: 1px; height: 20px; background: #555; margin: 0 5px;">
                            </div>
                            <button class="tool-btn" data-cmd="insertUnorderedList"
                                title="Lista com Marcadores">•</button>
                            <button class="tool-btn" data-cmd="insertOrderedList" title="Lista Numerada">1.</button>
                            <div class="separator" style="width: 1px; height: 20px; background: #555; margin: 0 5px;">
                            </div>
                            <button class="tool-btn icon-only" data-cmd="justifyLeft" title="Alinhar à Esquerda"><img
                                    src="img/icons/editor/left.svg" alt="Left"></button>
                            <button class="tool-btn icon-only" data-cmd="justifyCenter" title="Centralizar"><img
                                    src="img/icons/editor/center.svg" alt="Center"></button>
                            <button class="tool-btn icon-only" data-cmd="justifyRight" title="Alinhar à Direita"><img
                                    src="img/icons/editor/right.svg" alt="Right"></button>
                            <button class="tool-btn icon-only" data-cmd="justifyFull" title="Justificar"><img
                                    src="img/icons/editor/justify.svg" alt="Justify"></button>
                            <div class="separator" style="width: 1px; height: 20px; background: #555; margin: 0 5px;">
                            </div>
                            <div class="color-picker-wrapper" title="Cor do Texto">
                                <img src="img/icons/editor/color.svg" alt="Color" class="color-icon">
                                <input type="color" id="editor-color" value="#e0e0e0">
                            </div>
                        </div>

                        <div id="journal-editor" contenteditable="true" placeholder="Escreva os detalhes da jornada...">
                        </div>

                        <div id="journal-actions" style="margin-top: 10px; display: flex; gap: 10px;">
                            <button id="btn-save-entry">Salvar Entrada</button>
                            <button id="btn-cancel-edit"
                                style="background-color: var(--col-bg-surface); border: 1px solid var(--col-accent-deep); display: none;">Cancelar
                                Edição</button>
                        </div>

                    </div>
                </div>
            </div>
        </div> <!-- End of #bottom-container -->
    </div> <!-- End of #main-content -->

    <div id="hexagon-modal" class="modal">
        <div class="modal-content">
            <div class="masthead">
                <div class="masthead-icon"><img src="img/icons/mastheads/weather.svg" alt=""></div>
                <div class="masthead-title">Hexflower de Clima</div>
                <span class="close-button">&times;</span>
            </div>
            <div class="modal-body-split">
                <div id="modal-left-column">
                    <p id="initial-hex-subtitle" class="subtitle" style="display: none;">Selecione o Hexágono de Clima
                        inicial</p>
                    <div id="modal-map-container"></div>
                    <div id="text-window"></div>
                </div>
                <div id="modal-controls-container">
                    <div id="temperature-container">
                        <div class="masthead">
                            <div class="masthead-icon"><img src="img/icons/mastheads/temperature-container.svg" alt="">
                            </div>
                            <div class="masthead-title">Tabela de Temperatura</div>
                        </div>
                        <div class="container-content">
                            <p class="subtitle">Role 1d12 e some com o modificador do hexagono selecionado do Hexflower
                                de
                                Temperatura, se houver algum modificador.</p>
                            <table id="temperature-table">
                                <tr>
                                    <td>d12</td>
                                    <td>Calor (MESES QUENTES)</td>
                                </tr>
                                <tr>
                                    <td>1 - 8</td>
                                    <td><b>Ameno</b>. Sem alterações.</td>
                                </tr>
                                <tr>
                                    <td>9 - 11</td>
                                    <td><b>Calor</b>. Água precisa ser consumida em cada Quarto de Dia para ficar
                                        DESIDRATADO.
                                    </td>
                                </tr>
                                <tr>
                                    <td>12</td>
                                    <td><b>Escaldante</b>. Água precisa ser consumida em cada Quarto de Dia para não
                                        ficar
                                        DESIDRATADO. Personagens usando armadura precisam fazer uma rolagem de
                                        Resiliência
                                        em
                                        cada
                                        Quarto de Dia, falha significa -1 de AGILIDADE.</td>
                                </tr>
                            </table>
                            <div id="dice-container-temp">
                                <div class="dice-wrapper">
                                    <div class="die-d12" id="die-d12">
                                        <svg viewBox="0 0 100 100" class="d12-svg">
                                            <polygon points="50,2 97,35 79,90 21,90 3,35"
                                                fill="var(--col-text-highlight)" stroke="var(--col-bg-main)"
                                                stroke-width="2" />
                                            <polygon points="50,25 74,42 65,70 35,70 26,42" fill="none"
                                                stroke="var(--col-bg-main)" stroke-width="2" />
                                            <line x1="50" y1="2" x2="50" y2="25" stroke="var(--col-bg-main)"
                                                stroke-width="2" />
                                            <line x1="97" y1="35" x2="74" y2="42" stroke="var(--col-bg-main)"
                                                stroke-width="2" />
                                            <line x1="79" y1="90" x2="65" y2="70" stroke="var(--col-bg-main)"
                                                stroke-width="2" />
                                            <line x1="21" y1="90" x2="35" y2="70" stroke="var(--col-bg-main)"
                                                stroke-width="2" />
                                            <line x1="3" y1="35" x2="26" y2="42" stroke="var(--col-bg-main)"
                                                stroke-width="2" />
                                        </svg>
                                        <span class="die-number">1</span>
                                    </div>
                                </div>
                                <button id="btn-roll-temp">Rolar 1d12</button>
                                <div id="dice-result-temp"></div>
                            </div>
                        </div>
                    </div>

                    <div id="weather-navigation">
                        <div class="masthead">
                            <div class="masthead-icon"><img src="img/icons/mastheads/weather-navigation.svg" alt="">
                            </div>
                            <div class="masthead-title">Navegação no Hexflower</div>
                        </div>
                        <div class="container-content">
                            <p class="subtitle">Role 2d6 e some, compare o resultado com o hexflower abaixo e mova no
                                hexflower
                                de temperatura para o hexagono indicado.</p>
                            <svg id="weather-nav-svg"></svg>
                            <div id="dice-container-nav">
                                <div class="dice-wrapper">
                                    <div class="die" id="die-1"></div>
                                    <div class="die" id="die-2"></div>
                                </div>
                                <button id="btn-roll-nav">Rolar 2d6</button>
                                <div id="dice-result-nav"></div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
        </div>
    </div>



    <div id="terrain-modal" class="modal">
        <div class="modal-content">
            <div class="masthead">
                <div class="masthead-icon"><img src="img/icons/mastheads/terrain.svg" alt=""></div>
                <div class="masthead-title">Terrenos Exploráveis</div>
                <span class="close-button">&times;</span>
            </div>
            <p class="subtitle" style="text-align: center; padding: 20px 20px 0 20px; margin: 0;">Selecione o
                Terreno
                atual</p>
            <div id="terrain-grid" style="padding: 20px;"></div>
        </div>
    </div>

    <div id="calendar-modal" class="modal">
        <div class="modal-content">
            <div class="masthead">
                <div class="masthead-icon"><img src="img/icons/mastheads/journal.svg" alt=""></div>
                <div class="masthead-title">Diário de Viagem</div>
                <span class="close-button">&times;</span>
            </div>
            <div class="modal-body-column">
                <div id="calendar-grid"></div>
                <div id="day-details"></div>

                <div id="modal-journal-section" style="display:none; margin-top: 20px;">
                    <div id="modal-journal-controls"
                        style="margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
                        <label for="modal-journal-quarter-select">Momento:</label>
                        <select id="modal-journal-quarter-select"
                            style="padding: 5px; border-radius: 4px; background: var(--col-bg-surface); color: var(--col-text-primary); border: 1px solid var(--col-accent-cool);">
                            <option value="0">Manhã</option>
                            <option value="1">Tarde</option>
                            <option value="2">Anoitecer</option>
                            <option value="3">Noite</option>
                        </select>
                    </div>

                    <div class="editor-toolbar modal-editor-toolbar">
                        <button class="tool-btn" data-cmd="bold" title="Negrito"><b>B</b></button>
                        <button class="tool-btn" data-cmd="italic" title="Itálico"><i>I</i></button>
                        <button class="tool-btn" data-cmd="underline" title="Sublinhado"><u>U</u></button>
                        <button class="tool-btn" data-cmd="superscript" title="Sobrescrito">X<sup>2</sup></button>
                        <div class="separator" style="width: 1px; height: 20px; background: #555; margin: 0 5px;">
                        </div>
                        <button class="tool-btn" data-cmd="insertUnorderedList" title="Lista com Marcadores">•</button>
                        <button class="tool-btn" data-cmd="insertOrderedList" title="Lista Numerada">1.</button>
                        <div class="separator" style="width: 1px; height: 20px; background: #555; margin: 0 5px;">
                        </div>
                        <button class="tool-btn icon-only" data-cmd="justifyLeft" title="Alinhar à Esquerda"><img
                                src="img/icons/editor/left.svg" alt="Left"></button>
                        <button class="tool-btn icon-only" data-cmd="justifyCenter" title="Centralizar"><img
                                src="img/icons/editor/center.svg" alt="Center"></button>
                        <button class="tool-btn icon-only" data-cmd="justifyRight" title="Alinhar à Direita"><img
                                src="img/icons/editor/right.svg" alt="Right"></button>
                        <button class="tool-btn icon-only" data-cmd="justifyFull" title="Justificar"><img
                                src="img/icons/editor/justify.svg" alt="Justify"></button>
                        <div class="separator" style="width: 1px; height: 20px; background: #555; margin: 0 5px;">
                        </div>
                        <div class="color-picker-wrapper" title="Cor do Texto">
                            <img src="img/icons/editor/color.svg" alt="Color" class="color-icon">
                            <input type="color" id="modal-editor-color" value="#e0e0e0">
                        </div>
                    </div>
                    <div id="modal-journal-editor" contenteditable="true"
                        placeholder="Escreva os detalhes da jornada...">
                    </div>

                    <div id="modal-journal-actions" style="margin-top: 10px; display: flex; gap: 10px;">
                        <button id="modal-btn-save-entry">Salvar Entrada</button>
                        <button id="modal-btn-cancel-edit"
                            style="background-color: var(--col-bg-surface); border: 1px solid var(--col-accent-deep);">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="start-game-modal" class="modal">
        <div class="modal-content start-game-content">
            <div class="masthead">
                <div class="masthead-icon"><img src="img/icons/mastheads/journal.svg" alt=""></div>
                <div class="masthead-title">Iniciar Viagem</div>
                <span class="close-button">&times;</span>
            </div>
            <div style="padding: 20px;">
                <div class="form-group">
                    <label for="start-year">Ano:</label>
                    <input type="number" id="start-year" value="1165">
                </div>
                <div class="form-group">
                    <label for="start-month">Mês:</label>
                    <select id="start-month"></select>
                </div>
                <div class="form-group">
                    <label for="start-day">Dia:</label>
                    <input type="number" id="start-day" min="1" max="46" value="1">
                </div>
                <button id="btn-start-game">DATA DEFINIDA</button>
            </div>
        </div>
    </div>

    <div id="info-modal" class="modal">
        <div class="modal-content">
            <div class="masthead">
                <div class="masthead-icon"><img src="img/icons/mastheads/info2.svg" alt=""></div>
                <div class="masthead-title">Informações</div>
                <span class="close-button">&times;</span>
            </div>
            <div id="info-content" style="padding: 20px;">
                <h2 data-path-to-node="2">Bem-vindo ao FBL Hexplorer Companion!</h2>
                <p data-path-to-node="3">Como o nome sugere, esta p&aacute;gina foi feita para te ajudar na
                    explora&ccedil;&atilde;o dos
                    hex&aacute;gonos durante suas sess&otilde;es de <em>Forbidden Lands</em>.</p>
                <h3 data-path-to-node="4">Como usar:</h3>
                <ul data-path-to-node="5">
                    <li>
                        <p data-path-to-node="5,0,0"><strong>Configura&ccedil;&atilde;o Inicial:</strong> Comece
                            escolhendo o dia,
                            m&ecirc;s e ano de in&iacute;cio da campanha. Isso definir&aacute; o mapa em
                            <em>Hexflower</em> que
                            ser&aacute; utilizado.
                        </p>
                    </li>
                    <li>
                        <p data-path-to-node="5,1,0"><strong>Clima:</strong> Selecione o clima inicial no mapa.
                            N&atilde;o tem jeito
                            certo para isso, apenas defina um arbitrariamente.</p>
                    </li>
                    <li>
                        <p data-path-to-node="5,2,0"><strong>Temperatura:</strong> Role <strong>1d12</strong>
                            (somando
                            b&ocirc;nus/redutores, se houver) para definir a temperatura aleatoriamente, ou clique
                            diretamente em uma
                            op&ccedil;&atilde;o na tabela.</p>
                    </li>
                    <li>
                        <p data-path-to-node="5,3,0"><strong>Terreno:</strong> Selecione o tipo de terreno onde o
                            personagem
                            est&aacute;.</p>
                    </li>
                    <li>
                        <p data-path-to-node="5,4,0"><strong>Viagem:</strong> Utilize das informa&ccedil;&otilde;es
                            contidas em
                            <strong>'Procedimentos de Viagem'</strong> para n&atilde;o esquecer nenhum detalhe
                            importante enquanto
                            estiver pelas <em>Terras Proibidas</em>.
                        </p>
                    </li>
                </ul>
                <p data-path-to-node="6"><strong>Navega&ccedil;&atilde;o e Di&aacute;rio:</strong> Use os
                    bot&otilde;es
                    <strong>DESBRAVAR</strong> e <strong>PERMANECER</strong> para avan&ccedil;ar o dia. Ao final do
                    dia,
                    o sistema
                    pedir&aacute; o clima do dia seguinte. Basta rolar <strong>2d6</strong>: o resultado
                    mover&aacute; o
                    clima para um
                    hex&aacute;gono adjacente (veja em <strong>'Navega&ccedil;&atilde;o no Hexflower'</strong>).
                    Voc&ecirc; pode clicar
                    tanto nos hex&aacute;gonos de navega&ccedil;&atilde;o quanto diretamente no mapa
                    <em>hexflower</em>
                    de clima.
                    Voc&ecirc; tamb&eacute;m precisar&aacute; rolar na tabela de temperatura novamente.
                </p>
                <p data-path-to-node="7">N&atilde;o esque&ccedil;a do <strong>Di&aacute;rio</strong>: use-o para
                    anotar
                    encontros,
                    tesouros, etc. Clicando na data atual, uma janela mostrar&aacute; o hist&oacute;rico dos dias
                    anteriores.</p>
                <hr data-path-to-node="8" />
                <h3 data-path-to-node="9">Sobre o Projeto</h3>
                <p data-path-to-node="10">Criei esta ferramenta pensando em jogos solo, mas a utilizo sempre que
                    mestro
                    para meu grupo.
                    Espero que fa&ccedil;a bom proveito na sua mesa!</p>
                <p data-path-to-node="11">A principal <em>feature</em> que me motivou a cria&ccedil;&atilde;o da
                    ferramenta foi a
                    <em>house-rule</em> de controle de clima atrav&eacute;s da navega&ccedil;&atilde;o por
                    <em>hexflower</em>,
                    ent&atilde;o esta &aacute;rea recebeu mais carinho, caso voc&ecirc; n&atilde;o conhe&ccedil;a,
                    este
                    &eacute; um
                    m&eacute;todo j&aacute; famoso na comunidade <em>hexcrawl</em> que faz a progress&atilde;o do
                    clima
                    ser menos
                    imprevis&iacute;vel e, com sorte, mais cr&iacute;vel. As regras, b&ocirc;nus e redutores que
                    usei
                    aqui s&atilde;o um
                    am&aacute;lgama de informa&ccedil;&otilde;es do <em>Livro do Mestre</em>, <em>Book of
                        Beasts</em> e
                    materiais da
                    comunidade, ajustados ao meu gosto pessoal.
                </p>
                <p data-path-to-node="12"><em>Este projeto &eacute; uma ferramenta independente criada por f&atilde;
                        e
                        n&atilde;o possui
                        qualquer inten&ccedil;&atilde;o de violar direitos autorais. Ele n&atilde;o cont&eacute;m,
                        reproduz ou distribui
                        material protegido por copyright do sistema de RPG de mesa Forbidden Lands, que &eacute;
                        propriedade da empresa
                        Free League Publishing. Todos os direitos sobre Forbidden Lands pertencem exclusivamente aos
                        seus respectivos
                        detentores</em></p>
            </div>
        </div>
    </div>

    <div id="general-info-modal" class="modal">
        <div class="modal-content">
            <div class="masthead">
                <div class="masthead-icon"><img src="img/icons/mastheads/weather.svg" alt=""></div>
                <div class="masthead-title" id="general-info-title">Clima</div>
                <span class="close-button">&times;</span>
            </div>
            <div id="general-info-content" style="padding: 20px; font-size: 1.1em; line-height: 1.6;"></div>
        </div>
    </div>

    <div id="toast-notification" class="toast"></div>

    <script src="hexagon_data.js"></script>
    <script src="script.js"></script>
</body>

</html>